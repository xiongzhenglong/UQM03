```sql
-- 数据库准备
-- CREATE DATABASE IF NOT EXISTS uqm_ecommerce_db CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci;
-- USE uqm_ecommerce_db;

-- ----------------------------
-- 1. 部门表 (departments)
-- 描述：存储公司的所有部门信息。
-- ----------------------------
CREATE TABLE IF NOT EXISTS departments (
    department_id INT AUTO_INCREMENT PRIMARY KEY,
    name VARCHAR(100) NOT NULL COMMENT '部门名称',
    location VARCHAR(100) COMMENT '办公地点',
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP COMMENT '创建时间'
) COMMENT='公司部门表';

-- ----------------------------
-- 2. 员工表 (employees)
-- 描述：存储公司员工信息，包含上下级汇报关系。
-- ----------------------------
CREATE TABLE IF NOT EXISTS employees (
    employee_id INT AUTO_INCREMENT PRIMARY KEY,
    first_name VARCHAR(50) NOT NULL COMMENT '名',
    last_name VARCHAR(50) NOT NULL COMMENT '姓',
    email VARCHAR(100) UNIQUE NOT NULL COMMENT '邮箱',
    phone_number VARCHAR(20) COMMENT '电话',
    hire_date DATE NOT NULL COMMENT '入职日期',
    job_title VARCHAR(100) NOT NULL COMMENT '职位',
    salary DECIMAL(10, 2) NOT NULL COMMENT '薪水',
    department_id INT COMMENT '所属部门ID',
    manager_id INT COMMENT '直属经理ID',
    is_active BOOLEAN DEFAULT TRUE COMMENT '是否在职',
    FOREIGN KEY (department_id) REFERENCES departments(department_id),
    FOREIGN KEY (manager_id) REFERENCES employees(employee_id) ON DELETE SET NULL
) COMMENT='员工信息表';

-- ----------------------------
-- 3. 客户表 (customers)
-- 描述：存储客户的基本信息。
-- ----------------------------
CREATE TABLE IF NOT EXISTS customers (
    customer_id INT AUTO_INCREMENT PRIMARY KEY,
    customer_name VARCHAR(100) NOT NULL COMMENT '客户姓名',
    email VARCHAR(150) UNIQUE NOT NULL COMMENT '客户邮箱',
    country VARCHAR(50) NOT NULL COMMENT '所在国家',
    city VARCHAR(50) COMMENT '所在城市',
    registration_date DATE NOT NULL COMMENT '注册日期',
    customer_segment ENUM('VIP', '普通', '新客户') DEFAULT '新客户' COMMENT '客户分层'
) COMMENT='客户信息表';

-- ----------------------------
-- 4. 供应商表 (suppliers)
-- 描述：存储产品供应商信息。
-- ----------------------------
CREATE TABLE IF NOT EXISTS suppliers (
    supplier_id INT AUTO_INCREMENT PRIMARY KEY,
    supplier_name VARCHAR(150) NOT NULL COMMENT '供应商名称',
    contact_person VARCHAR(100) COMMENT '联系人',
    phone VARCHAR(20) COMMENT '联系电话',
    country VARCHAR(50) NOT NULL COMMENT '所在国家'
) COMMENT='供应商信息表';

-- ----------------------------
-- 5. 产品表 (products)
-- 描述：存储商品信息。
-- ----------------------------
CREATE TABLE IF NOT EXISTS products (
    product_id INT AUTO_INCREMENT PRIMARY KEY,
    product_name VARCHAR(200) NOT NULL COMMENT '产品名称',
    category VARCHAR(100) NOT NULL COMMENT '产品类别',
    unit_price DECIMAL(10, 2) NOT NULL COMMENT '单价',
    supplier_id INT COMMENT '供应商ID',
    discontinued BOOLEAN DEFAULT FALSE COMMENT '是否已下架',
    FOREIGN KEY (supplier_id) REFERENCES suppliers(supplier_id)
) COMMENT='产品目录表';

-- ----------------------------
-- 6. 订单主表 (orders)
-- 描述：存储客户订单的概要信息。
-- ----------------------------
CREATE TABLE IF NOT EXISTS orders (
    order_id INT AUTO_INCREMENT PRIMARY KEY,
    customer_id INT NOT NULL COMMENT '客户ID',
    employee_id INT COMMENT '负责员工ID',
    order_date DATETIME NOT NULL COMMENT '下单日期',
    status ENUM('待处理', '处理中', '已发货', '已完成', '已取消') NOT NULL COMMENT '订单状态',
    shipping_fee DECIMAL(8, 2) DEFAULT 0.00 COMMENT '运费',
    FOREIGN KEY (customer_id) REFERENCES customers(customer_id),
    FOREIGN KEY (employee_id) REFERENCES employees(employee_id)
) COMMENT='客户订单主表';

-- ----------------------------
-- 7. 订单详情表 (order_items)
-- 描述：存储每个订单中包含的具体商品项。
-- ----------------------------
CREATE TABLE IF NOT EXISTS order_items (
    order_item_id INT AUTO_INCREMENT PRIMARY KEY,
    order_id INT NOT NULL COMMENT '订单ID',
    product_id INT NOT NULL COMMENT '产品ID',
    quantity INT NOT NULL COMMENT '数量',
    unit_price DECIMAL(10, 2) NOT NULL COMMENT '成交单价',
    discount DECIMAL(4, 2) DEFAULT 0.00 COMMENT '折扣率',
    FOREIGN KEY (order_id) REFERENCES orders(order_id) ON DELETE CASCADE,
    FOREIGN KEY (product_id) REFERENCES products(product_id)
) COMMENT='订单商品详情表';

-- ----------------------------
-- 8. 仓库表 (warehouses)
-- 描述：存储仓库信息。
-- ----------------------------
CREATE TABLE IF NOT EXISTS warehouses (
    warehouse_id INT AUTO_INCREMENT PRIMARY KEY,
    warehouse_name VARCHAR(100) NOT NULL COMMENT '仓库名称',
    location VARCHAR(100) NOT NULL COMMENT '仓库位置'
) COMMENT='仓库信息表';

-- ----------------------------
-- 9. 库存表 (inventory)
-- 描述：存储每个产品在不同仓库的库存水平。
-- ----------------------------
CREATE TABLE IF NOT EXISTS inventory (
    inventory_id INT AUTO_INCREMENT PRIMARY KEY,
    product_id INT NOT NULL COMMENT '产品ID',
    warehouse_id INT NOT NULL COMMENT '仓库ID',
    quantity_on_hand INT NOT NULL COMMENT '现有库存量',
    last_updated TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
    UNIQUE KEY (product_id, warehouse_id),
    FOREIGN KEY (product_id) REFERENCES products(product_id),
    FOREIGN KEY (warehouse_id) REFERENCES warehouses(warehouse_id)
) COMMENT='产品库存表';
```

您好！您提供的这套数据库结构非常全面和专业，确实能支持非常多样的业务查询场景。基于这些表，我为您构思了以下一些常见的查询与分析场景，由浅入深，希望能给您带来启发：

### **一、 人力资源与部门管理 (HR & Department)**

这类查询主要围绕 `employees` 和 `departments` 表。

* **基础查询**:
    * 查询“信息技术部”的所有在职员工列表。
    ```json
    {
    "uqm": {
        "metadata": {
        "name": "信息技术部在职员工列表",
        "description": "查询信息技术部所有在职员工的详细信息"
        },
        "steps": [
        {
            "name": "get_it_active_employees",
            "type": "query",
            "config": {
            "data_source": "employees",
            "dimensions": [
                "employees.employee_id",
                "employees.first_name",
                "employees.last_name",
                "employees.email",
                "employees.phone_number",
                "employees.hire_date",
                "employees.job_title",
                "employees.salary",
                "departments.name AS department_name",
                "departments.location AS department_location"
            ],
            "joins": [
                {
                "type": "INNER",
                "table": "departments",
                "on": {
                    "left": "employees.department_id",
                    "right": "departments.department_id",
                    "operator": "="
                }
                }
            ],
            "filters": [
                {
                "field": "departments.name",
                "operator": "=",
                "value": "信息技术部"
                },
                {
                "field": "employees.is_active",
                "operator": "=",
                "value": true
                }
            ]
            }
        }
        ],
        "output": "get_it_active_employees"
    },
    "parameters": {},
    "options": {}
    }
    ------------------------------------------------------------------------------
    {
        "success": true,
        "data": [
            {
                "employee_id": 1,
                "first_name": "伟",
                "last_name": "张",
                "email": "zhang.wei@example.com",
                "phone_number": "13800138001",
                "hire_date": "2022-01-10",
                "job_title": "IT总监",
                "salary": "35000.00",
                "department_name": "信息技术部",
                "department_location": "上海"
            },
            {
                "employee_id": 3,
                "first_name": "强",
                "last_name": "李",
                "email": "li.qiang@example.com",
                "phone_number": "13800138003",
                "hire_date": "2022-02-20",
                "job_title": "软件工程师",
                "salary": "18000.00",
                "department_name": "信息技术部",
                "department_location": "上海"
            },
            {
                "employee_id": 10,
                "first_name": "Emily",
                "last_name": "Jones",
                "email": "emily.jones@example.com",
                "phone_number": "13700137009",
                "hire_date": "2024-04-08",
                "job_title": "高级软件工程师",
                "salary": "22000.00",
                "department_name": "信息技术部",
                "department_location": "上海"
            }
        ],
        "metadata": {
            "name": "信息技术部在职员工列表",
            "description": "查询信息技术部所有在职员工的详细信息",
            "version": "1.0",
            "author": "",
            "created_at": null,
            "updated_at": null,
            "tags": []
        },
        "execution_info": {
            "total_time": 0.05601000785827637,
            "row_count": 3,
            "cache_hit": false,
            "steps_executed": 1
        },
        "step_results": [
            {
                "step_name": "get_it_active_employees",
                "step_type": "query",
                "status": "completed",
                "data": null,
                "row_count": 3,
                "execution_time": 0.05601000785827637,
                "cache_hit": false,
                "error": null
            }
        ]
    }
    ```
    * 查找所有在2023年之后入职的员工。
    ```json
    {
    "uqm": {
        "metadata": {
        "name": "2023年后入职员工",
        "description": "查询所有在2023年之后入职的员工列表"
        },
        "steps": [
        {
            "name": "get_employees_hired_after_2023",
            "type": "query",
            "config": {
            "data_source": "employees",
            "dimensions": [
                "employee_id",
                "first_name",
                "last_name",
                "email",
                "hire_date",
                "job_title",
                "salary"
            ],
            "filters": [
                {
                "field": "hire_date",
                "operator": ">",
                "value": "2023-12-31"
                }
            ]
            }
        }
        ],
        "output": "get_employees_hired_after_2023"
    },
    "parameters": {},
    "options": {}
    }
    --------------------------------------------------------------------------------------
    {
        "success": true,
        "data": [
            {
                "employee_id": 9,
                "first_name": "Yuki",
                "last_name": "Tanaka",
                "email": "yuki.tanaka@example.com",
                "hire_date": "2024-02-19",
                "job_title": "市场专员",
                "salary": "14000.00"
            },
            {
                "employee_id": 10,
                "first_name": "Emily",
                "last_name": "Jones",
                "email": "emily.jones@example.com",
                "hire_date": "2024-04-08",
                "job_title": "高级软件工程师",
                "salary": "22000.00"
            },
            {
                "employee_id": 11,
                "first_name": "Carlos",
                "last_name": "Garcia",
                "email": "carlos.garcia@example.com",
                "hire_date": "2025-01-15",
                "job_title": "运营经理",
                "salary": "31000.00"
            },
            {
                "employee_id": 12,
                "first_name": "Sophia",
                "last_name": "Müller",
                "email": "sophia.muller@example.com",
                "hire_date": "2025-03-20",
                "job_title": "销售助理",
                "salary": "16000.00"
            }
        ],
        "metadata": {
            "name": "2023年后入职员工",
            "description": "查询所有在2023年之后入职的员工列表",
            "version": "1.0",
            "author": "",
            "created_at": null,
            "updated_at": null,
            "tags": []
        },
        "execution_info": {
            "total_time": 0.04599642753601074,
            "row_count": 4,
            "cache_hit": false,
            "steps_executed": 1
        },
        "step_results": [
            {
                "step_name": "get_employees_hired_after_2023",
                "step_type": "query",
                "status": "completed",
                "data": null,
                "row_count": 4,
                "execution_time": 0.04599642753601074,
                "cache_hit": false,
                "error": null
            }
        ]
    }
    ```
    * 获取某位员工（如：张伟）的详细信息，包括他所在的部门名称和办公地点。
    ```json
    {
    "uqm": {
        "metadata": {
        "name": "查询特定员工详情",
        "description": "获取张伟的详细信息，包括他所在的部门名称和办公地点"
        },
        "steps": [
        {
            "name": "get_zhang_wei_details",
            "type": "query",
            "config": {
            "data_source": "employees",
            "dimensions": [
                "employees.employee_id",
                "employees.first_name",
                "employees.last_name",
                "employees.email",
                "employees.job_title",
                "employees.salary",
                "departments.name AS department_name",
                "departments.location AS department_location"
            ],
            "joins": [
                {
                "type": "LEFT",
                "table": "departments",
                "on": {
                    "left": "employees.department_id",
                    "right": "departments.department_id",
                    "operator": "="
                }
                }
            ],
            "filters": [
                {
                "field": "employees.first_name",
                "operator": "=",
                "value": "张"
                },
                {
                "field": "employees.last_name",
                "operator": "=",
                "value": "伟"
                }
            ]
            }
        }
        ],
        "output": "get_zhang_wei_details"
    },
    "parameters": {},
    "options": {}
    }
    ---------------------------------------------------------------------------------------------
    {
        "success": true,
        "data": [
            {
                "employee_id": 1,
                "first_name": "张",
                "last_name": "伟",
                "email": "zhang.wei@example.com",
                "job_title": "IT总监",
                "salary": "35000.00",
                "department_name": "信息技术部",
                "department_location": "上海"
            }
        ],
        "metadata": {
            "name": "查询特定员工详情",
            "description": "获取张伟的详细信息，包括他所在的部门名称和办公地点",
            "version": "1.0",
            "author": "",
            "created_at": null,
            "updated_at": null,
            "tags": []
        },
        "execution_info": {
            "total_time": 0.05763673782348633,
            "row_count": 1,
            "cache_hit": false,
            "steps_executed": 1
        },
        "step_results": [
            {
                "step_name": "get_zhang_wei_details",
                "step_type": "query",
                "status": "completed",
                "data": null,
                "row_count": 1,
                "execution_time": 0.05663704872131348,
                "cache_hit": false,
                "error": null
            }
        ]
    }
    ```

* **聚合分析**:
    * 统计每个部门的员工人数，并按人数降序排列。
    ```json
    {
    "uqm": {
        "metadata": {
        "name": "部门员工人数统计",
        "description": "统计每个部门的员工人数，并按人数降序排列"
        },
        "steps": [
        {
            "name": "department_employee_count",
            "type": "query",
            "config": {
            "data_source": "employees",
            "dimensions": [
                "departments.name AS department_name"
            ],
            "metrics": [
                {
                "name": "employees.employee_id",
                "aggregation": "COUNT",
                "alias": "employee_count"
                }
            ],
            "joins": [
                {
                "type": "INNER",
                "table": "departments",
                "on": {
                    "left": "employees.department_id",
                    "right": "departments.department_id",
                    "operator": "="
                }
                }
            ],
            "group_by": [
                "departments.name"
            ],
            "order_by": [
                {
                "field": "employee_count",
                "direction": "DESC"
                }
            ]
            }
        }
        ],
        "output": "department_employee_count"
    },
    "parameters": {},
    "options": {}
    }
    ----------------------------------------------------------------------------------------------------
    {
        "success": true,
        "data": [
            {
                "department_name": "信息技术部",
                "employee_count": 3
            },
            {
                "department_name": "人力资源部",
                "employee_count": 2
            },
            {
                "department_name": "销售部",
                "employee_count": 2
            },
            {
                "department_name": "欧洲销售部",
                "employee_count": 2
            },
            {
                "department_name": "研发中心",
                "employee_count": 1
            },
            {
                "department_name": "财务部",
                "employee_count": 1
            },
            {
                "department_name": "市场营销部",
                "employee_count": 1
            }
        ],
        "metadata": {
            "name": "部门员工人数统计",
            "description": "统计每个部门的员工人数，并按人数降序排列",
            "version": "1.0",
            "author": "",
            "created_at": null,
            "updated_at": null,
            "tags": []
        },
        "execution_info": {
            "total_time": 0.024122238159179688,
            "row_count": 7,
            "cache_hit": false,
            "steps_executed": 1
        },
        "step_results": [
            {
                "step_name": "department_employee_count",
                "step_type": "query",
                "status": "completed",
                "data": null,
                "row_count": 7,
                "execution_time": 0.024122238159179688,
                "cache_hit": false,
                "error": null
            }
        ]
    }
    ```
    * 计算每个部门的平均薪资、最高薪资和最低薪资。
    ```json
    {
    "uqm": {
        "metadata": {
        "name": "部门薪资统计",
        "description": "计算每个部门的平均薪资、最高薪资和最低薪资"
        },
        "steps": [
        {
            "name": "department_salary_stats",
            "type": "query",
            "config": {
            "data_source": "employees",
            "dimensions": [
                "departments.name AS department_name"
            ],
            "metrics": [
                {
                "name": "employees.salary",
                "aggregation": "AVG",
                "alias": "avg_salary"
                },
                {
                "name": "employees.salary",
                "aggregation": "MAX",
                "alias": "max_salary"
                },
                {
                "name": "employees.salary",
                "aggregation": "MIN",
                "alias": "min_salary"
                }
            ],
            "joins": [
                {
                "type": "INNER",
                "table": "departments",
                "on": {
                    "left": "employees.department_id",
                    "right": "departments.department_id",
                    "operator": "="
                }
                }
            ],
            "group_by": [
                "departments.name"
            ]
            }
        }
        ],
        "output": "department_salary_stats"
    },
    "parameters": {},
    "options": {}
    }
    ----------------------------------------------------------------------------------------------------------
    {
        "success": true,
        "data": [
            {
                "department_name": "信息技术部",
                "avg_salary": "25000.000000",
                "max_salary": "35000.00",
                "min_salary": "18000.00"
            },
            {
                "department_name": "人力资源部",
                "avg_salary": "18500.000000",
                "max_salary": "25000.00",
                "min_salary": "12000.00"
            },
            {
                "department_name": "销售部",
                "avg_salary": "26500.000000",
                "max_salary": "38000.00",
                "min_salary": "15000.00"
            },
            {
                "department_name": "财务部",
                "avg_salary": "28000.000000",
                "max_salary": "28000.00",
                "min_salary": "28000.00"
            },
            {
                "department_name": "欧洲销售部",
                "avg_salary": "29000.000000",
                "max_salary": "42000.00",
                "min_salary": "16000.00"
            },
            {
                "department_name": "市场营销部",
                "avg_salary": "14000.000000",
                "max_salary": "14000.00",
                "min_salary": "14000.00"
            },
            {
                "department_name": "研发中心",
                "avg_salary": "31000.000000",
                "max_salary": "31000.00",
                "min_salary": "31000.00"
            }
        ],
        "metadata": {
            "name": "部门薪资统计",
            "description": "计算每个部门的平均薪资、最高薪资和最低薪资",
            "version": "1.0",
            "author": "",
            "created_at": null,
            "updated_at": null,
            "tags": []
        },
        "execution_info": {
            "total_time": 0.05674409866333008,
            "row_count": 7,
            "cache_hit": false,
            "steps_executed": 1
        },
        "step_results": [
            {
                "step_name": "department_salary_stats",
                "step_type": "query",
                "status": "completed",
                "data": null,
                "row_count": 7,
                "execution_time": 0.05674409866333008,
                "cache_hit": false,
                "error": null
            }
        ]
    }
    ```
    * 按年份统计每年入职的员工数量。
    ```json
    {
    "uqm": {
        "metadata": {
        "name": "按年份入职员工数量统计",
        "description": "按年份统计每年入职的员工数量"
        },
        "steps": [
        {
            "name": "employees_hired_by_year",
            "type": "query",
            "config": {
            "data_source": "employees",
            "dimensions": [
                {
                "expression": "YEAR(hire_date)",
                "alias": "hire_year"
                }
            ],
            "metrics": [
                {
                "name": "employee_id",
                "aggregation": "COUNT",
                "alias": "employee_count"
                }
            ],
            "group_by": [
                "hire_year"
            ],
            "order_by": [
                {
                "field": "hire_year",
                "direction": "ASC"
                }
            ]
            }
        }
        ],
        "output": "employees_hired_by_year"
    },
    "parameters": {},
    "options": {}
    }
    --------------------------------------------------------------------------------------------
    {
        "success": true,
        "data": [
            {
                "hire_year": 2020,
                "employee_count": 1
            },
            {
                "hire_year": 2021,
                "employee_count": 1
            },
            {
                "hire_year": 2022,
                "employee_count": 4
            },
            {
                "hire_year": 2023,
                "employee_count": 2
            },
            {
                "hire_year": 2024,
                "employee_count": 2
            },
            {
                "hire_year": 2025,
                "employee_count": 2
            }
        ],
        "metadata": {
            "name": "按年份入职员工数量统计",
            "description": "按年份统计每年入职的员工数量",
            "version": "1.0",
            "author": "",
            "created_at": null,
            "updated_at": null,
            "tags": []
        },
        "execution_info": {
            "total_time": 0.037999629974365234,
            "row_count": 6,
            "cache_hit": false,
            "steps_executed": 1
        },
        "step_results": [
            {
                "step_name": "employees_hired_by_year",
                "step_type": "query",
                "status": "completed",
                "data": null,
                "row_count": 6,
                "execution_time": 0.037999629974365234,
                "cache_hit": false,
                "error": null
            }
        ]
    }
    ```

* **关联与层级查询**:
    * 查询所有员工及其直属经理的姓名（需要在 `employees` 表上进行自连接）。
    ```json
    {
    "uqm": {
        "metadata": {
        "name": "员工及其直属经理姓名查询",
        "description": "查询所有员工的姓名及其直属经理的姓名，即使员工没有经理也会被列出。"
        },
        "steps": [
        {
            "name": "employees_and_managers",
            "type": "query",
            "config": {
            "data_source": "employees",
            "dimensions": [
                {
                "expression": "CONCAT(employees.first_name, ' ', employees.last_name)",
                "alias": "employee_full_name"
                },
                {
                "expression": "CONCAT(managers.first_name, ' ', managers.last_name)",
                "alias": "manager_full_name"
                }
            ],
            "joins": [
                {
                "type": "LEFT",
                "table": "employees AS managers",
                "on": {
                    "left": "employees.manager_id",
                    "right": "managers.employee_id",
                    "operator": "="
                }
                }
            ],
            "order_by": [
                {
                "field": "employee_full_name",
                "direction": "ASC"
                }
            ]
            }
        }
        ],
        "output": "employees_and_managers"
    },
    "parameters": {},
    "options": {}
    }
    --------------------------------------------------------------------------------------------------------------------
    {
        "success": true,
        "data": [
            {
                "employee_full_name": "Carlos Garcia",
                "manager_full_name": null
            },
            {
                "employee_full_name": "Emily Jones",
                "manager_full_name": "张 伟"
            },
            {
                "employee_full_name": "Ming Li",
                "manager_full_name": null
            },
            {
                "employee_full_name": "Peter Schmidt",
                "manager_full_name": "陈 军"
            },
            {
                "employee_full_name": "Sophia Müller",
                "manager_full_name": "Peter Schmidt"
            },
            {
                "employee_full_name": "Yuki Tanaka",
                "manager_full_name": null
            },
            {
                "employee_full_name": "刘 娜",
                "manager_full_name": "王 芳"
            },
            {
                "employee_full_name": "张 伟",
                "manager_full_name": null
            },
            {
                "employee_full_name": "李 强",
                "manager_full_name": "张 伟"
            },
            {
                "employee_full_name": "杨 静",
                "manager_full_name": "陈 军"
            },
            {
                "employee_full_name": "王 芳",
                "manager_full_name": null
            },
            {
                "employee_full_name": "陈 军",
                "manager_full_name": null
            }
        ],
        "metadata": {
            "name": "员工及其直属经理姓名查询",
            "description": "查询所有员工的姓名及其直属经理的姓名，即使员工没有经理也会被列出。",
            "version": "1.0",
            "author": "",
            "created_at": null,
            "updated_at": null,
            "tags": []
        },
        "execution_info": {
            "total_time": 0.05534505844116211,
            "row_count": 12,
            "cache_hit": false,
            "steps_executed": 1
        },
        "step_results": [
            {
                "step_name": "employees_and_managers",
                "step_type": "query",
                "status": "completed",
                "data": null,
                "row_count": 12,
                "execution_time": 0.05534505844116211,
                "cache_hit": false,
                "error": null
            }
        ]
    }
    ```
    * 列出所有没有分配部门的员工。
    ```json
    {
    "uqm": {
        "metadata": {
        "name": "未分配部门员工列表",
        "description": "列出所有没有分配部门的员工的详细信息。"
        },
        "steps": [
        {
            "name": "employees_without_department",
            "type": "query",
            "config": {
            "data_source": "employees",
            "dimensions": [
                "employee_id",
                "first_name",
                "last_name",
                "email",
                "job_title",
                "salary",
                "hire_date"
            ],
            "filters": [
                {
                "field": "department_id",
                "operator": "IS NULL"
                }
            ],
            "order_by": [
                {
                "field": "employee_id",
                "direction": "ASC"
                }
            ]
            }
        }
        ],
        "output": "employees_without_department"
    },
    "parameters": {},
    "options": {}
    }
    --------------------------------------------------------------------------------------------
    {
        "success": true,
        "data": [],
        "metadata": {
            "name": "未分配部门员工列表",
            "description": "列出所有没有分配部门的员工的详细信息。",
            "version": "1.0",
            "author": "",
            "created_at": null,
            "updated_at": null,
            "tags": []
        },
        "execution_info": {
            "total_time": 0.0503692626953125,
            "row_count": 0,
            "cache_hit": false,
            "steps_executed": 1
        },
        "step_results": [
            {
                "step_name": "employees_without_department",
                "step_type": "query",
                "status": "completed",
                "data": null,
                "row_count": 0,
                "execution_time": 0.0503692626953125,
                "cache_hit": false,
                "error": null
            }
        ]
    }
    ```

### **二、 销售与订单分析 (Sales & Order)**

这类查询是电商系统的核心，主要涉及 `orders`, `order_items`, `products`, `customers` 等表。

* **基础查询**:
    * 查询某个特定订单（如 order_id = 1）的所有商品项及其详情。
    ```json
    {
    "uqm": {
        "metadata": {
        "name": "特定订单商品详情查询",
        "description": "查询指定订单ID下所有商品项的详细信息，包括商品名称、类别、数量、单价、折扣及计算后的总价。",
        "version": "1.0",
        "author": "UQM Team"
        },
        "steps": [
        {
            "name": "order_items_details",
            "type": "query",
            "config": {
            "data_source": "order_items",
            "dimensions": [
                "order_items.order_item_id",
                "order_items.order_id",
                "order_items.product_id",
                "order_items.quantity",
                {
                "expression": "order_items.unit_price",
                "alias": "item_sale_price"
                },
                "order_items.discount",
                "products.product_name",
                "products.category",
                {
                "expression": "(order_items.quantity * order_items.unit_price * (1 - order_items.discount))",
                "alias": "total_item_price"
                }
            ],
            "joins": [
                {
                "type": "INNER",
                "table": "products",
                "on": {
                    "left": "order_items.product_id",
                    "right": "products.product_id",
                    "operator": "="
                }
                }
            ],
            "filters": [
                {
                "field": "order_items.order_id",
                "operator": "=",
                "value": "$orderId"
                }
            ],
            "order_by": [
                {
                "field": "order_items.order_item_id",
                "direction": "ASC"
                }
            ]
            }
        }
        ],
        "output": "order_items_details"
    },
    "parameters": {
        "orderId": 1
    },
    "options": {
        
    }
    }
    -----------------------------------------------------------------------------------------------------------------------
    {
        "success": true,
        "data": [
            {
                "order_item_id": 1,
                "order_id": 1,
                "product_id": 1,
                "quantity": 1,
                "item_sale_price": "499.00",
                "discount": "0.05",
                "product_name": "超高速SSD 1TB",
                "category": "电子产品",
                "total_item_price": "474.0500"
            },
            {
                "order_item_id": 2,
                "order_id": 1,
                "product_id": 2,
                "quantity": 1,
                "item_sale_price": "380.00",
                "discount": "0.05",
                "product_name": "机械键盘",
                "category": "电子产品",
                "total_item_price": "361.0000"
            }
        ],
        "metadata": {
            "name": "特定订单商品详情查询",
            "description": "查询指定订单ID下所有商品项的详细信息，包括商品名称、类别、数量、单价、折扣及计算后的总价。",
            "version": "1.0",
            "author": "UQM Team",
            "created_at": null,
            "updated_at": null,
            "tags": []
        },
        "execution_info": {
            "total_time": 0.02700042724609375,
            "row_count": 2,
            "cache_hit": false,
            "steps_executed": 1
        },
        "step_results": [
            {
                "step_name": "order_items_details",
                "step_type": "query",
                "status": "completed",
                "data": null,
                "row_count": 2,
                "execution_time": 0.02700042724609375,
                "cache_hit": false,
                "error": null
            }
        ]
    }
    ```
    * 查找所有状态为“待处理”的订单，以便进行后续操作。
    ```json
    {
    "uqm": {
        "metadata": {
        "name": "待处理订单列表",
        "description": "列出所有状态为'待处理'的订单的详细信息。",
        "version": "1.0",
        "author": "UQM Team"
        },
        "steps": [
        {
            "name": "pending_orders",
            "type": "query",
            "config": {
            "data_source": "orders",
            "dimensions": [
                "order_id",
                "customer_id",
                "employee_id",
                "order_date",
                "status",
                "shipping_fee"
            ],
            "filters": [
                {
                "field": "status",
                "operator": "=",
                "value": "待处理"
                }
            ],
            "order_by": [
                {
                "field": "order_date",
                "direction": "ASC"
                }
            ]
            }
        }
        ],
        "output": "pending_orders"
    },
    "parameters": {},
    "options": {
        "cache_enabled": true
    }
    }
    -------------------------------------------------------------------------------------------------
    {
        "success": true,
        "data": [
            {
                "order_id": 4,
                "customer_id": 1,
                "employee_id": 6,
                "order_date": "2024-03-10T09:00:00",
                "status": "待处理",
                "shipping_fee": "10.00"
            }
        ],
        "metadata": {
            "name": "待处理订单列表",
            "description": "列出所有状态为'待处理'的订单的详细信息。",
            "version": "1.0",
            "author": "UQM Team",
            "created_at": null,
            "updated_at": null,
            "tags": []
        },
        "execution_info": {
            "total_time": 0.044182538986206055,
            "row_count": 1,
            "cache_hit": false,
            "steps_executed": 1
        },
        "step_results": [
            {
                "step_name": "pending_orders",
                "step_type": "query",
                "status": "completed",
                "data": null,
                "row_count": 1,
                "execution_time": 0.043177127838134766,
                "cache_hit": false,
                "error": null
            }
        ]
    }
    ```

* **销售业绩分析**:
    * 统计上个月（或指定时间段内）的总销售额（`order_items.quantity * order_items.unit_price`）。
    ```json
    {
    "uqm": {
        "metadata": {
        "name": "指定时间段总销售额",
        "description": "计算指定时间段内所有订单的总销售额（含折扣）。",
        "version": "1.0",
        "author": "UQM Team"
        },
        "steps": [
        {
            "name": "total_sales_calculation",
            "type": "query",
            "config": {
            "data_source": "order_items",
            "dimensions": [],
            "metrics": [
                {
                "expression": "SUM(order_items.quantity * order_items.unit_price * (1 - order_items.discount))",
                "alias": "total_sales_amount"
                }
            ],
            "joins": [
                {
                "type": "INNER",
                "table": "orders",
                "on": {
                    "left": "order_items.order_id",
                    "right": "orders.order_id",
                    "operator": "="
                }
                }
            ],
            "filters": [
                {
                "field": "orders.order_date",
                "operator": ">=",
                "value": "$startDate"
                },
                {
                "field": "orders.order_date",
                "operator": "<=",
                "value": "$endDate"
                }
            ]
            }
        }
        ],
        "output": "total_sales_calculation"
    },
    "parameters": {
        "startDate": "2024-11-01 00:00:00",
        "endDate": "2024-11-30 23:59:59"
    },
    "options": {
    
    }
    }
    ----------------------------------------------------------------------------------------------------
    {
        "success": true,
        "data": [
            {
                "total_sales_amount": "1519.0500"
            }
        ],
        "metadata": {
            "name": "指定时间段总销售额",
            "description": "计算指定时间段内所有订单的总销售额（含折扣）。",
            "version": "1.0",
            "author": "UQM Team",
            "created_at": null,
            "updated_at": null,
            "tags": []
        },
        "execution_info": {
            "total_time": 0.03469657897949219,
            "row_count": 1,
            "cache_hit": false,
            "steps_executed": 1
        },
        "step_results": [
            {
                "step_name": "total_sales_calculation",
                "step_type": "query",
                "status": "completed",
                "data": null,
                "row_count": 1,
                "execution_time": 0.03469657897949219,
                "cache_hit": false,
                "error": null
            }
        ]
    }
    ```
    * 查询销量最高（或销售额最高）的 Top 10 商品。
    * 计算网站的平均客单价 (AOV, Average Order Value)。
    * 按产品类别（category）统计销售额和销量，找出最受欢迎的品类。

* **折扣与利润分析**:
    * 计算每个订单的总折扣金额。
    * 分析不同产品或品类的平均折扣率。

### **三、 客户行为分析 (Customer Behavior)**

主要围绕 `customers`, `orders`, `order_items` 表。

* **基础查询**:
    * 查询某位客户（如：孙悟空）的所有历史订单。
    * 按国家或城市统计客户数量，分析客户的地理分布。

* **客户价值分析**:
    * 找出消费总额最高的 Top 10 VIP 客户。
    * 根据客户的注册日期、订单频率和消费金额，对客户进行分层（如高价值客户、潜力客户、流失风险客户）。
    * 查询最近一次下单时间距今已超过6个月的客户列表（流失预警）。

* **复购分析**:
    * 统计所有客户的平均复购率。
    * 找出复购次数最多的客户。

### **四、 产品与供应链管理 (Product, Supplier & Inventory)**

涉及 `products`, `suppliers`, `inventory`, `warehouses` 表。

* **基础查询**:
    * 查询某个供应商（如：华南电子配件厂）提供的所有在售商品。
    * 查找指定商品（如：机械键盘）在所有仓库的总库存量。

* **库存与成本分析**:
    * 列出所有库存低于警戒线（例如20件）的商品，以便及时补货。
    * 计算每个仓库中所有商品的总库存价值（`inventory.quantity_on_hand * products.unit_price`）。
    * 找出已经停产 (`discontinued` = TRUE) 但仍有库存的商品。

* **供应商分析**:
    * 统计每个供应商提供的产品种类数量。
    * 找出为“电子产品”类别供货的所有中国供应商。

### **五、 综合跨模块分析 (Complex Scenarios)**

这类查询通常需要连接三张或更多表，代表了更复杂的业务洞察需求。

* **员工业绩与销售关联分析**:
    * 查询某个销售代表（employee）在指定季度内完成的所有订单的总金额，用于计算提成。

* **客户偏好与产品关联分析**:
    * 分析来自不同国家的客户最喜欢购买的商品类别是什么。
    * 找出购买了“机械键盘”的客户，还同时购买了哪些其他商品（购物篮分析）。

* **供应链与销售关联分析**:
    * 分析来自不同供应商的产品的平均销售额和销量，评估供应商价值。

以上这些场景几乎涵盖了从简单查询、多表连接、聚合分组到复杂的业务洞察。每一个场景都可以通过组合使用您系统中的 `query`, `enrich`, `pivot` 等步骤，用 JSON Schema 的形式来实现。