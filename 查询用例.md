好的，作为BI分析师，我将根据您提供的数据库表结构，为您构思100个查询统计场景，并进行分类，以帮助您更好地理解和利用这些数据。

这些场景涵盖了人事管理、销售与客户分析、产品与库存管理以及供应链管理等核心业务领域，并利用了各个表及其之间的关系。

---

### 查询统计场景分类及示例 (共100个)

** 人力资源管理 (Human Resources Management) - 基于 `departments` 和 `employees` 表**

*   **员工信息与分布**
    1.  查询并返回“信息技术部”所有在职状态员工的详细信息。
    2.  查询所有在2023年之后入职的员工列表。
    3.  获取张伟的详细信息，包括他所在的部门名称和办公地点。
    4.  统计每个部门的员工人数，并按人数降序排列。
    5.  计算每个部门的平均薪资、最高薪资和最低薪资。
    6.  按年份统计每年入职的员工数量。
    7.  查询所有员工及其直属经理的姓名（需要在 `employees` 表上进行自连接）。
    8.  列出所有没有分配部门的员工。
    9.  查询某个特定订单（如 order_id = 1）的所有商品项及其详情。
    10. 查找所有状态为“待处理”的订单，以便进行后续操作。
    11. 统计上个月（或指定时间段内）的总销售额（`order_items.quantity * order_items.unit_price`）。
    12. 查询销量最高（或销售额最高）的 Top 10 商品。
        13. 计算网站的平均客单价 (AOV, Average Order Value)
    14. 按产品类别（category）统计销售额和销量，找出最受欢迎的品类。
    15. 找出入职时间最长的N名员工，用于表彰或分析员工稳定性。
*   **部门与组织结构**
    16. 查询所有部门的名称（`name`）和办公地点（`location`）。
    17. 统计不同办公地点的部门数量。
    18. 查询特定办公地点（如“上海”）的所有部门。
    19. 分析员工入职年限分布情况。
    20. 找出特定部门中薪水高于部门平均薪水的员工。

** 销售与客户分析 (Sales & Customer Analysis) - 基于 `customers`, `orders`, `order_items`, `products`, `employees` 表**

*   **客户行为与价值**
    21. 查询所有客户的基本信息。
    22. 统计不同客户分层（`customer_segment`）的客户数量，如VIP、普通、新客户。
    23. 查询特定国家（`country`）或城市（`city`）的客户列表。
    24. 找出注册日期（`registration_date`）在特定时间范围内的客户。
    25. 统计每个国家或城市的客户数量。
    26. 找出总消费金额（通过 `orders` 和 `order_items` 计算）最高的N名VIP客户。
    27. 找出从未下过订单的注册客户。
    28. 查询特定客户的所有订单历史记录。
    29. 统计每个客户分层的平均订单数量。
    30. 统计每个客户分层的总消费金额。
    31. 分析新客户（`customer_segment`='新客户'）在注册后N天内的首单转化率。
    32. 找出最近N天内有过购买行为的客户。
    33. 查询特定客户的邮箱（`email`）以便进行营销活动。
    34. 分析不同地理位置（`country`, `city`）客户的消费偏好（通过购买产品类别）。
    35. 找出购买力最强的N个国家或城市。
*   **订单与销售额分析**
    36. 查询所有订单的基本信息，包括客户和负责员工。
    37. 统计不同订单状态（`status`）的订单数量。
    38. 查询特定日期范围（`order_date`）内的订单总数及总销售额。
    39. 计算每日/每周/每月/每年的总销售额及销售趋势。
    40. 计算不同产品类别（`category`）的销售额和销售数量。
    41. 找出销售额最高的N笔订单。
    42. 找出订单项（`order_items`）数量最多的N笔订单。
    43. 分析订单的平均运费（`shipping_fee`）及其在不同订单状态下的分布。
    44. 统计订单的平均折扣率（`discount`）。
    45. 找出折扣率最高的N个订单项，分析促销效果。
    46. 统计每个负责员工（`employee_id`）的销售额排名。
    47. 统计每个负责员工的订单数量。
    48. 找出销售业绩最好的N名员工.
    49. 找出销售业绩最差的N名员工.
    50. 分析客户平均订单价值（AOV）。
    51. 统计特定时间段内“已完成”状态的订单数量。
    52. 找出“待处理”或“处理中”状态的订单，以便跟进。
    53. 查询已取消（`status`='已取消'）的订单数量及相关信息。
    54. 统计不同国家或地区（通过客户 `country`/`city`）的销售额分布。
    55. 分析运费占总销售额的比例。
    56. 找出包含多种产品的订单数量，分析交叉销售潜力。
    57. 查询特定产品在不同订单中的销售数量和成交单价。
    58. 统计每个订单的平均商品项数量。
    59. 月度/季度/年度销售额对比分析，评估增长率。
    60. 找出特定员工负责的VIP客户订单情况。
*   **产品销售表现**
    61. 找出销量最好的N种产品。
    62. 找出销售额最高的N种产品。
    63. 统计每个产品类别（`category`）的销售额和销量。
    64. 查询特定产品（`product_id`）的所有订单项信息。
    65. 找出单价（`unit_price`）最高/最低的N种产品。
    66. 分析不同供应商（`supplier_id`）提供的产品的销售表现。
    67. 查询已下架（`discontinued`='是'）但仍有销售记录的产品。
    68. 找出特定客户购买最多的产品类别。
    69. 统计在订单中被频繁组合购买的产品对。
    70. 分析特定产品在不同季节的销售趋势（需结合 `order_date`）。

** 产品与库存管理 (Product & Inventory Management) - 基于 `products`, `inventory`, `warehouses` 表**

*   **产品信息与状态**
    71. 查询所有产品列表及其类别（`category`）和单价（`unit_price`）。
    72. 统计每个产品类别的产品数量。
    73. 查询已下架（`discontinued`）的产品列表。
    74. 找出特定供应商（`supplier_id`）提供的所有产品。
    75. 分析产品生命周期（通过 `discontinued` 状态和销售数据）。
*   **库存现状与预警**
    76. 查询所有仓库列表及其位置（`location`）。
    77. 统计每个仓库的现有库存量（`quantity_on_hand`）总和。
    78. 统计每个仓库库存的产品种类数量。
    79. 找出库存量（`quantity_on_hand`）最低的N种产品，用于补货预警。
    80. 找出库存量最高的N种产品，分析滞销情况。
    81. 查询特定产品在所有仓库的库存分布情况.
    82. 查询所有仓库中，现有库存量低于某个阈值（如100件）的产品。
    83. 找出长时间（如30天）未进行库存更新（`last_updated`）的仓库或产品。
    84. 统计公司总库存量及总库存价值（按产品单价计算）。
    85. 分析特定仓库的库存周转率（需结合销售数据计算）。
    86. 查询特定产品在哪个仓库有库存。
    87. 找出所有仓库中没有任何库存的产品.
    88. 统计不同产品类别的总库存量.
    89. 分析特定仓库的库存容量利用率（需额外数据，但可根据现有库存量推断）.
    90. 检查是否存在库存记录中 `product_id` 或 `warehouse_id` 不存在于主表的情况。

** 供应链管理 (Supply Chain Management) - 基于 `suppliers`, `products`, `inventory`, `warehouses` 表**

*   **供应商管理与绩效**
    91. 查询所有供应商（`suppliers`）列表及其联系人（`contact_person`）。
    92. 统计不同国家（`country`）的供应商数量。
    93. 找出提供产品种类最多的N个供应商。
    94. 找出其产品销售额最高的N个供应商。
    95. 分析特定供应商提供的产品是否存在库存不足的问题。
    96. 查询特定供应商提供的所有产品列表及其库存状态。
    97. 评估不同供应商的供货准时性（需外部数据，但可从库存更新频率间接推断）。
    98. 找出产品已下架但仍有供应商信息的记录。

** 综合与交叉分析 (Integrated & Cross-cutting Analysis)**
    99. **部门销售业绩分析**: 统计每个部门（通过员工的 `department_id`）所产生的总销售额，并进行排名。
    100. **地区销售额贡献**: 分析不同国家或城市（客户的 `country`, `city`）对总销售额的贡献比例.

这些场景可以帮助您从不同维度对业务数据进行深入分析和洞察，支持决策制定。